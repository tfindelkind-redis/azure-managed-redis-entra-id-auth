# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-dev/main/schemas/v1.0/azure.yaml.json

# Azure Developer CLI (azd) configuration
# This deploys a test environment with Azure Managed Redis and a VM for testing examples
name: redis-entra-id-test-env
metadata:
  template: redis-entra-id-test-env@0.0.1

# Note: This project uses custom deployment scripts for infrastructure
# The script handles the full deployment because:
# - Redis can take 15-20+ minutes to provision
# - Access policy assignments need Redis to be fully provisioned first
# - We need to save outputs to azd env for test scripts
#
# Usage:
#   azd up                              # Deploy infrastructure
#   ./run.sh setup                      # Copy examples to VM
#   ./run.sh all                        # Run all examples
#
# Environment Variables (set via azd env set):
# - REDIS_CLUSTER_POLICY: 'OSSCluster' or 'EnterpriseCluster' (default: EnterpriseCluster)
# - REDIS_SKU: Balanced_B5, MemoryOptimized_M10, etc. (default: Balanced_B5)
# - VM_ADMIN_PASSWORD: VM password (auto-generated if not set)

# Infrastructure configuration - azd will deploy this bicep template
infra:
  provider: bicep
  path: ./infra
  module: main

# No application services - this is infrastructure-only for testing
# The VM will be used to run the example code manually
